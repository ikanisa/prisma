{
  "meta": {
    "key": "malta_cit_2025",
    "version": "v1.0.0",
    "title": "Malta CIT 2025"
  },
  "inputs": {
    "accounting_profit": { "type": "number", "description": "Accounting profit before tax" },
    "add_backs": {
      "type": "array",
      "item": {
        "type": "object",
        "fields": {
          "label": { "type": "string" },
          "amount": { "type": "number" }
        }
      }
    },
    "deductions": {
      "type": "array",
      "item": {
        "type": "object",
        "fields": {
          "label": { "type": "string" },
          "amount": { "type": "number" }
        }
      }
    },
    "losses_bf": { "type": "number", "description": "Losses brought forward" },
    "tax_rate": { "type": "number", "default": 0.35, "description": "Applicable CIT rate" }
  },
  "calculations": {
    "total_add_backs": "sum(add_backs[].amount)",
    "total_deductions": "sum(deductions[].amount)",
    "taxable_income_pre_losses": "accounting_profit + total_add_backs - total_deductions",
    "taxable_income": "max(0, taxable_income_pre_losses - losses_bf)",
    "tax_payable": "round(taxable_income * tax_rate, 2)"
  },
  "validations": [
    {
      "expression": "tax_rate >= 0 && tax_rate <= 1",
      "message": "tax_rate must be between 0 and 1"
    },
    {
      "expression": "taxable_income >= 0",
      "message": "taxable_income must be non-negative"
    }
  ]
}
