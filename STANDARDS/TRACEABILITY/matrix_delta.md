# Traceability Matrix Delta (Go-Live Audit)

| Module | Requirement / Story | Control Delta | Evidence / Tests to Add |
| --- | --- | --- | --- |
| Tasks (HF-1) | HF-1 endpoints must return 200 with auth + org scoping | Add API smoke test covering `/v1/tasks` happy path; reference Supabase RLS (`supabase/migrations/20250926090000_tasks_documents_notifications.sql`). | `tests/api/test_core_smoke.py` (tasks coverage) + staging curl output attached to release ticket. |
| Documents (HF-2) | Signed upload, archive/restore, signed URL access only | Implement storage bucket policies + signed URL TTL audit; document checksum verification. | Migration `20250927100000_documents_storage_policy.sql`, `tests/test_documents_signing.py`, screenshot of UI upload flow. |
| Notifications (HF-3) | Users can fetch + mark notifications read | Include smoke asserting `/v1/notifications` list + `mark-all`; highlight RLS policy in migration file. | `tests/api/test_core_smoke.py` (notifications coverage) + screenshots. |
| Assistant (HF-4) | Assistant dock accessible on all primary pages; can create task, surface docs, start onboarding | Document assistant tool coverage (unit tests for `tool_create_task`, `tool_list_documents`, `tool_start_onboarding`). | Test plan referencing `server/main.py:1040-1380`, UI walkthrough recording. |
| Onboarding (HF-5) | Start, link docs, commit checklist produces draft entity | Add evidence linking API responses + Supabase records; include Playwright flow for onboarding page. | `tests/api/onboarding-smoke.test.ts`, Supabase table screenshots (checklists, items, drafts). |
| Document AI (HF-6) | Extraction pipeline marks docs DONE, updates provenance | Extend `tests/test_autopilot_worker.py` with assertions for provenance; document Supabase `document_extractions` schema. | Test update + Supabase row samples. |
| Autopilot (HF-7) | Jobs + schedules manageable with role checks | Capture runbook for enabling worker, include k6 smoke plan; ensure RLS policies referenced. | Autopilot smoke report, metrics screenshot, policy references in matrix. |
| Accounting Close (A-1) | TB snapshot, journals, bank recon, close lock flows accessible | Cross-link to acceptance evidence (existing tests/pages), note need for API smoke of `/v1/accounting/*` endpoints. | Test artifacts from `src/pages/accounting/index.tsx`, Supabase tables, manual walkthrough. |
| Audit Stream (D/E) | Activity log/events RLS updated | Point matrix to new `activity_event_catalog` RLS migration and tests. | Migration ID `20250926181500_activity_event_catalog_rls.sql`, test plan. |
| Tax T-1..T-4 | Pillar Two relationships persisted & calculators intact | Ensure post-merge Pillar Two view uses live Supabase table; add tests mapping relationships to API. | Pillar Two UI screenshots, regression tests after conflict resolution. |
